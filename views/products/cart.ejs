<%- include('../../partials/header')%>
<%- include('../../partials/navbar')%>

<div style="display:flex; flex-direction: row; flex-wrap: wrap; ; justify-content: space-evenly;  width:100vw">
    <div  style="display:flex; justify-content:center; align-items:center; flex-direction: column; margin-top: 1rem;
    gap:2rem;">
        <h2>Cart Items</h2>
        <% if (cartitems && Array.isArray(cartitems)) { %>
            <% cartitems.forEach(product => { %>
                <div class="card" style="width: 15rem; height:28rem; background-color: rgb(206, 204, 200);">
                    <img src="<%= product.img %>" class="card-img-top" alt="..." style="height:50%;">
                    <div class="card-body" style="height:50%;">
                    <h5 class="card-title" style="text-align: center;"><%= product.name%></h5>
                    <h5 class="card-title">Rs <%= product.price%></h5>
                    <!-- <h5 class="card-text rating">Rating <%= product.rating %> </h5> -->
                    <p class="card-text"><%=product.desc.substring(0,60) %>...</p>
                    <div style="display:flex; flex-direction: row; justify-content: space-evenly; align-items: center; gap:1rem;">
                        <div>
                            <a href="/products/<%=product.id%>" class="btn btn-primary">Show</a>
                        </div>
                        <div>
                            <a href="/users/<%=product.id%>/delete" class="btn btn-primary">Remove</a>
                        </div>
                    </div>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <p>No items in the cart</p>
        <% } %>  
    </div>
    <div class="totalprice" style="display:flex; gap:1rem; flex-direction: column; margin-top: 6rem; text-align: center; border:2px solid black; background-color: rgba(169, 169, 169, 0.158); height:max-content; padding:2rem;">
        <h2>Total Price(
            <%if(currUser){%>
                <%=cartlength%> Items
            <%}%>
        )</h2>
        <% let total = 0; %>
        <% if (cartitems && Array.isArray(cartitems)) { %>
            <% cartitems.forEach(product => { %>
                <% total += product.price %>
                <div class="items" style="display:flex; flex-direction: row; gap: 2rem; text-align: center; justify-content: center; align-items: center; border:2px solid black; background-color: rgba(169, 169, 169, 0.281); padding:0.5rem">
                    <div>
                        <h4><%=product.name%></h4>
                    </div>
                    <div>
                        <h4>Rs <%=product.price%></h4>
                    </div>
                </div>
            <%})%>
            <div style="border:2px solid black; background-color: rgba(169, 169, 169, 0.281);" >
               <h3 id="total-amount">Total Price =  <%= total %></h3>
            </div>
        <%}%>
    </div>
    <div style="margin-top:6rem; border: 2px solid black; padding:1rem; background-color: rgba(0, 0, 255, 0.388); height: max-content; border-radius: 5%;">
        <a href="" id="place-order" style="text-decoration: none; color:black;">Place Order</a>
    </div>
</div>

<script src="/css/js/placeOrder.js"></script>
<%-include('../../partials/footer')%>
